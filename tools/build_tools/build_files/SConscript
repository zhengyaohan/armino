from building import *

cwd  = GetCurrentDir()

list = os.listdir(cwd)

sys_config = os.path.join(cwd, '..', 'config', 'sys_config.h')
options = LocalOptions(sys_config)

src = []
src += ["components/driver/audio/ring_buffer_dma_write.c"]
src += ["components/driver/common/dd.c"]
src += ["components/driver/common/drv_model.c"]
src += ["components/driver/fft/fft.c"]
src += ["components/driver/flash/flash.c"]
src += ["components/driver/general_dma/general_dma.c"]
src += ["components/driver/i2s/i2s.c"]
src += ["components/driver/icu/icu.c"]
src += ["components/driver/irda/irda.c"]
src += ["components/driver/macphy_bypass/mac_phy_bypass.c"]
src += ["components/driver/pwm/mcu_ps_timer.c"]
src += ["components/driver/pwm_driver.c"]
src += ["components/driver/timer_driver.c"]
src += ["components/driver/dma_driver.c"]
src += ["components/driver/icu_driver.c"]
src += ["components/driver/uart_driver.c"]
src += ["components/driver/uart_statis.c"]
src += ["components/driver/wdt_driver.c"]
src += ["components/driver/trng_driver.c"]
src += ["components/driver/efuse_driver.c"]
src += ["components/driver/spi_driver.c"]
src += ["components/driver/spi_statis.c"]
src += ["components/driver/gpio_driver_base.c"]
src += ["components/driver/adc_driver.c"]
src += ["components/driver/adc_statis.c"]
src += ["components/driver/interrupt_base.c"]
src += ["components/driver/saradc/saradc.c"]
src += ["components/driver/sdcard/sdcard.c"]
src += ["components/driver/sdcard/sdio_driver.c"]
src += ["components/driver/spidma/spidma.c"]
src += ["components/driver/spi/spi_psram.c"]
src += ["components/driver/spi/spi_flash.c"]
src += ["components/driver/jpeg/jpeg_encoder.c"]
src += ["components/driver/i2c/i2c1.c"]
src += ["components/driver/i2c/i2c2.c"]
src += ["components/driver/sys_ctrl/sys_ctrl.c"]
src += ["components/driver/uart/Retarget.c"]
src += ["components/driver/uart/uart.c"]
src += ["components/driver/dsp/dsp.c"]
src += ["components/driver/rw_pub/rw_platf_pub.c"]
src += ["components/driver/driver.c"]
src += ["components/bk_rtos/rttos/source/rtos_pub.c"]
src += ["components/bk_rtos/rttos/source/port.c"]
src += ["components/bk_rtos/rttos/source/port_asm.S"]
src += ["components/bk_rtos/rttos/source/rtos_task.c"]
src += ["components/bk_rtos/rttos/mem_arch.c"]
src += ["components/bk_rtos/rttos/str_arch.c"]
src += ["components/bk_rtos/rttos/target_util.c"]
src += ["components/bk_system/tick_base.c"]
src += ["components/bk_system/printf_base.c"]
src += ["components/bk_system/os/rttos/tick.c"]
src += ["components/bk_system/os/rttos/printf.c"]
src += ["components/bk_system/mac.c"]
src += ["components/bk_system/reboot.c"]
src += ["components/bk_adapter/lib_adapter.c"]
src += ["components/saradc_intf/saradc_intf.c"]
src += ["components/http/utils_httpc.c"]
src += ["components/http/utils_net.c"]
src += ["components/http/utils_timer.c"]
src += ["components/http/lite-log.c"]
src += ["components/app/video_work/video_transfer_tcp.c"]
src += ["components/app/video_work/video_transfer_udp.c"]
src += ["components/app/video_work/video_buffer.c"]
src += ["components/app/net_work/video_demo_main.c"]
src += ["components/app/net_work/video_demo_station.c"]
src += ["components/app/net_work/video_demo_softap.c"]


if (GetLocalDepend(options, 'CONFIG_SOC_BK7271') == 1):
	src += ["components/driver/i2c/i2c1_bk7271.c"]
	src += ["components/driver/mailbox/mailbox.c"]
	src += ["components/driver/gpio/gpio_bk7271.c"]
	src += ["components/driver/spi/spi_bk7271.c"]
	src += ["components/driver/spi/spi_slave_bk7271.c"]
	src += ["components/driver/spi/spi_master_bk7271.c"]
	src += ["components/driver/pwm/timer_bk7271.c"]
	src += ["components/driver/qspi/qspi_bk7271.c"]
else:
	src += ["components/driver/spi/spi.c"]
	src += ["components/driver/spi/spi_master.c"]
	src += ["components/driver/spi/spi_slave.c"]
	src += ["components/driver/gpio/gpio.c"]
	src += ["components/driver/qspi/qspi.c"]

src += ["components/bk_log/log.c"]
src += ["components/audio/audio_intf.c"]
src += ["components/driver/pm/pm_model.c"]
src += ["components/driver/pm/normal_sleep/normal_sleep.c"]
src += ["components/bk_init/components_init.c"]
src += ["components/bk_init/legacy_init.c"]
src += ["components/bk_init/reset_reason.c"]
src += ["components/temp_detect/temp_detect.c"]
src += ["components/user_driver/BkDriverFlash.c"]
src += ["components/bk_netif/bk_netif.c"]
src += ["components/bk_libs/sys_config.c"]
src += ["components/bk_libs/sys_config_check.c"]
src += ["components/bk_event/event.c"]
src += ["components/bk_ate/ate.c"]

src += ["components/user_driver/BkDriverQspi.c"]
src += ["components/usb_plug/usb_plug.c"]

if (GetLocalDepend(options, 'CONFIG_WPA3') == 1):
    src += ["components/wolfssl/wolfcrypt/src/wolfmath.c"]
    src += ["components/wolfssl/wolfcrypt/src/memory.c"]
    src += ["components/wolfssl/wolfcrypt/src/tfm.c"]
    src += ["components/wolfssl/wolfcrypt/src/ecc.c"]
    src += ["components/wolfssl/wolfcrypt/src/random.c"]
    src += ["components/wolfssl/wolfcrypt/src/sha256.c"]

src += ["components/spidma_intf/spidma_intf.c"]
src += ["components/camera_intf/camera_intf.c"]
src += ["components/video_transfer/video_transfer.c"]

if (GetLocalDepend(options, 'CONFIG_LWIP_2_0_2') == 1):
    src += ["components/lwip_intf_v2_0/dhcpd/dhcp-server.c"]
    src += ["components/lwip_intf_v2_0/dhcpd/dhcp-server-main.c"]

if (GetLocalDepend(options, 'CONFIG_LWIP_2_1_2') == 1):
    src += ["components/lwip_intf_v2_1/dhcpd/dhcp-server.c"]
    src += ["components/lwip_intf_v2_1/dhcpd/dhcp-server-main.c"]


path = []
path += [cwd + '/components/driver/include']
path += [cwd + '/components/driver/include/bk_private']
path += [cwd + '/components/driver/include/bk_private/legacy']
path += [cwd + '/components/user_driver/include']
path += [cwd + '/components/user_driver/include/bk_private']
path += [cwd + '/components/bk_libs/include/bk_private']
path += [cwd + '/components/bk_log/include']
path += [cwd + '/components/bk_wifi/include']
path += [cwd + '/components/bk_wifi/include/bk_private']
path += [cwd + '/components/bk_wifi/include/bk_private/legacy']
path += [cwd + '/components/bk_event/include']
path += [cwd + '/components/bk_event/include/bk_private']
path += [cwd + '/components/bk_common/include']
path += [cwd + '/components/bk_common/include/bk_private']
path += [cwd + '/components/bk_common/include/bk_private/legacy']
path += [cwd + '/components/bk_netif/include']
path += [cwd + '/components/bk_netif/include/bk_private']
path += [cwd + '/components/bk_hostapd/include']
path += [cwd + '/components/bk_hostapd/include/bk_private']
path += [cwd + '/components/bk_cli/include']
path += [cwd + '/components/bk_cli/include/bk_private']
path += [cwd + '/components/bk_ps/include']
path += [cwd + '/components/bk_ps/include/bk_private']
path += [cwd + '/components/rf_test/include']
path += [cwd + '/components/rf_test/include/bk_private']
path += [cwd + '/components/wpa_supplicant-2.9/include']
path += [cwd + '/components/wpa_supplicant-2.9/include/bk_private']
path += [cwd + '/components/rwnx_intf/include']
path += [cwd + '/components/rwnx_intf/include/bk_private']
path += [cwd + '/components/rwnx_intf/include/bk_private/legacy']
path += [cwd + '/components/music_player/include']
path += [cwd + '/components/music_player/include/bk_private']
path += [cwd + '/components/bk_cal/include']
path += [cwd + '/components/bk_cal/include/bk_private']
path += [cwd + '/components/net_param_intf/include']
path += [cwd + '/components/net_param_intf/include/bk_private']
path += [cwd + '/components/time/include']
path += [cwd + '/components/time/include/bk_private']
path += [cwd + '/components/wpa_supplicant-2.9/include']
path += [cwd + '/components/wpa_supplicant-2.9/include/bk_private']
path += [cwd + '/components/app']
path += [cwd + '/components/app/config']
path += [cwd + '/components/app/standalone-ap']
path += [cwd + '/components/http']
path += [cwd + '/components/app/standalone-station']
path += [cwd + '/components/app/led']
path += [cwd + '/components/app/app_demo']
path += [cwd + '/components/app/video_work']
path += [cwd + '/components/app/net_work']
path += [cwd + '/components/bk_init/include']
path += [cwd + '/common']
path += [cwd + '/release']
path += [cwd + '/components/driver/include']
path += [cwd + '/components/driver/audio']
path += [cwd + '/components/driver/codec']
path += [cwd + '/components/driver/common']
path += [cwd + '/components/driver/common/reg']
path += [cwd + '/components/driver/dma']
path += [cwd + '/components/driver/entry']
path += [cwd + '/components/driver/fft']
path += [cwd + '/components/driver/flash']
path += [cwd + '/components/driver/general_dma']
path += [cwd + '/components/driver/gpio']
path += [cwd + '/components/driver/i2s']
path += [cwd + '/components/driver/icu']
path += [cwd + '/components/driver/irda']
path += [cwd + '/components/driver/trng']
path += [cwd + '/components/driver/macphy_bypass']
path += [cwd + '/components/driver/phy']
path += [cwd + '/components/driver/pwm']
path += [cwd + '/components/driver/qspi']
path += [cwd + '/components/driver/rc_beken']
path += [cwd + '/components/driver/saradc']
path += [cwd + '/components/driver/sdcard']
path += [cwd + '/components/driver/sdio']
path += [cwd + '/components/driver/spi']
path += [cwd + '/components/driver/spidma']
path += [cwd + '/components/driver/sys_ctrl']
path += [cwd + '/components/driver/uart']
path += [cwd + '/components/driver/wdt']
path += [cwd + '/components/driver/trng']
path += [cwd + '/components/driver/mailbox']
path += [cwd + '/components/driver/rw_pub']
path += [cwd + '/components/driver/jpeg']
path += [cwd + '/components/driver/i2c']
path += [cwd + '/components/driver/security']
path += [cwd + '/components/driver/pm']
path += [cwd + '/components/driver/pm/normal_sleep']
path += [cwd + '/components/time']
path += [cwd + '/components/bk_wifi']
path += [cwd + '/components/sdio_intf']
path += [cwd + '/components/usb']
path += [cwd + '/components/usb/include']
path += [cwd + '/components/usb/include/class']
path += [cwd + '/components/usb/src/cd']
path += [cwd + '/components/usb/src/drivers/comm']
path += [cwd + '/components/usb/src/drivers/compl']
path += [cwd + '/components/usb/src/drivers/hid']
path += [cwd + '/components/usb/src/drivers/hub']
path += [cwd + '/components/usb/src/drivers/msd']
path += [cwd + '/components/usb/src/drivers/trans']
path += [cwd + '/components/usb/src/examples']
path += [cwd + '/components/usb/src/hid']
path += [cwd + '/components/usb/src/msc']
if (GetLocalDepend(options, 'CONFIG_USB_DEVICE') == 1):
    path += [cwd + '/components/usb/src/systems/none']
    path += [cwd + '/components/usb/src/systems/none/afs']
elif (GetLocalDepend(options, 'CONFIG_USB_HOST') == 1):
    path += [cwd + '/components/usb/src/systems/os']
    path += [cwd + '/components/usb/src/systems/os/afs']
path += [cwd + '/components/usb/src/test']
path += [cwd + '/components/usb/src/test/cbs']
path += [cwd + '/components/usb/src/test/compl']
path += [cwd + '/components/usb/src/test/hub']
path += [cwd + '/components/usb/src/uvc']
path += [cwd + '/components/bk_rtos/include']
path += [cwd + '/components/bk_rtos/include/bk_private']
path += [cwd + '/components/bk_rtos/rttos/include']
path += [cwd + '/components/bk_system/include']
path += [cwd + '/components/bk_system/os/rttos']
if (GetLocalDepend(options, 'CONFIG_SOC_BK7271') == 1):
	path += [cwd + '/components/bk_system/soc/bk7271']
else:
	path += [cwd + '/components/bk_system/soc/bk7231n']
path += [cwd + '/components/rttos/ate']
path += [cwd + '/components']
path += [cwd + '/components/motor']
path += [cwd + '/components/rf_test']
path += [cwd + '/components/joint_up']
path += [cwd + '/components/temp_detect']
path += [cwd + '/components/user_driver']
path += [cwd + '/components/power_save']
path += [cwd + '/components/ethernet_intf']
path += [cwd + '/components/bk_audio/pcm_resampler']
path += [cwd + '/components/bk_audio/vad']
path += [cwd + 'components/usb']
path += [cwd + 'components/usb/include']
path += [cwd + 'components/usb/src/msc']

path += [cwd + '/components/wpa_supplicant-2.9/src']
path += [cwd + '/components/wpa_supplicant-2.9/bk_patch']
path += [cwd + '/components/wpa_supplicant-2.9/hostapd']
path += [cwd + '/components/wpa_supplicant-2.9/src/utils']
path += [cwd + '/components/wpa_supplicant-2.9/src/drivers']
path += [cwd + '/components/wpa_supplicant-2.9/src/common']
path += [cwd + '/components/wpa_supplicant-2.9/wpa_supplicant']
path += [cwd + '/components/wpa_supplicant-2.9/src/common/']
path += [cwd + '/components/vad']
path += [cwd + '/components/bk_ate/include']
path += [cwd + '/components/spidma_intf']
path += [cwd + '/components/camera_intf']
path += [cwd + '/components/video_transfer']
path += [cwd + '/components/voice_transfer']

if (GetLocalDepend(options, 'CONFIG_LWIP_2_0_2') == 1):
    path += [cwd + '/components/lwip_intf_v2_0/dhcpd']

if (GetLocalDepend(options, 'CONFIG_LWIP_2_1_2') == 1):
    path += [cwd + '/components/lwip_intf_v2_1/dhcpd']

if (GetLocalDepend(options, 'CONFIG_BLE_5_X') == 1):
    path += [cwd + '/components/bk_ble/ble_v5/include']
    path += [cwd + '/components/bk_ble/ble_v5/include/bk_private']

if (GetLocalDepend(options, 'CONFIG_BLE_4_2') == 1):
    path += [cwd + '/components/bk_ble/ble_v4/include']
    path += [cwd + '/components/bk_ble/ble_v4/include/bk_private']

path += [cwd + '/components/ble_wifi_exchange']
path += [cwd + '/components/saradc_intf']
path += [cwd + '/components/sensor']
if (GetLocalDepend(options, 'CONFIG_WPA3') == 1):
    path += [cwd + '/components/wolfssl']

if (GetLocalDepend(options, 'CONFIG_SOC_BK7231N') == 1):
    src += ["components/driver/calendar/calendar.c"]
    path += [cwd + '/components/driver/calendar']

if (GetLocalDepend(options, 'CONFIG_SOC_BK7251') == 1):
	SOC_TARGET_NAME = "bk7251"
elif (GetLocalDepend(options, 'CONFIG_SOC_BK7231U') == 1):
	SOC_TARGET_NAME = "bk7251"
elif (GetLocalDepend(options, 'CONFIG_SOC_BK7231N') == 1):
	SOC_TARGET_NAME = "bk7231n"
elif (GetLocalDepend(options, 'CONFIG_SOC_BK7236') == 1):
	SOC_TARGET_NAME = "bk7231n"
elif (GetLocalDepend(options, 'CONFIG_SOC_BK7271') == 1):
	SOC_TARGET_NAME = "bk7271"
else:
	SOC_TARGET_NAME = "bk7231n"

path += [cwd + "/components/hal/" + SOC_TARGET_NAME ]
path += [cwd + "/components/soc/" + SOC_TARGET_NAME ]
path += [cwd + "/components/driver/" + SOC_TARGET_NAME ]
path += [cwd + "/components/hal/include"]
path += [cwd + "/components/soc/include"]
src += ["components/hal/" + SOC_TARGET_NAME + "/icu_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/icu_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/pwm_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/pwm_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/timer_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/timer_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/gpio_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/gpio_ll.c"]
src += ["components/driver/" + SOC_TARGET_NAME + "/gpio_driver.c"]
src += ["components/driver/" + SOC_TARGET_NAME + "/interrupt.c"]
src += ["components/driver/" + SOC_TARGET_NAME + "/interrupt_statis.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/dma_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/dma_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/uart_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/uart_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/wdt_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/wdt_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/trng_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/trng_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/efuse_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/efuse_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/adc_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/adc_ll.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/spi_hal_debug.c"]
src += ["components/hal/" + SOC_TARGET_NAME + "/spi_ll.c"]
src += ["components/hal/icu_hal.c"]
src += ["components/hal/pwm_hal.c"]
src += ["components/hal/timer_hal.c"]
src += ["components/hal/gpio_hal.c"]
src += ["components/hal/dma_hal.c"]
src += ["components/hal/uart_hal.c"]
src += ["components/hal/wdt_hal.c"]
src += ["components/hal/trng_hal.c"]
src += ["components/hal/efuse_hal.c"]
src += ["components/hal/adc_hal.c"]
src += ["components/hal/spi_hal.c"]

libs = ["libip.a"]
libs += ["libbk_cal.a"]
libs += ["libbk_hostapd.a"]
libs += ["libmac_tx_cache.a"]
libs += ["librwnx_intf.a"]
libs += ["libbk_wifi.a"]
libs += ["libble_wifi_exchange.a"]
libs += ["libpower_save.a"]
libs += ["libwpa_supplicant-2.9.a"]
libs += ["libbk_coex.a"]
libs += ["libnet_param_intf.a"]
libs += ["librf_test.a"]
libs += ["libuart_debug.a"]
libs += ["libpcm_resampler.a"]
libs += ["libvad.a"]

if (GetLocalDepend(options, 'CONFIG_BLE_4_2') == 1):
	libs += ["libble.a"]

if (GetLocalDepend(options, 'CONFIG_BLE_5_X') == 1):
	libs += ["libble_pub.a"]
	libs += ["libhci.a"]
	libs += ["libplatform.a"]
	libs += ["libhost.a"]
	libs += ["libmodules.a"]
	libs += ["libble_cli.a"]
	libs += ["libcontroller.a"]

if (GetLocalDepend(options, 'CONFIG_BT') == 1):
	libs += ["libbt.a"]

if (GetLocalDepend(options, 'CONFIG_USB') == 1):
	libs += ["libusb.a"]

libpath = [cwd + "/components/bk_libs/armino_internal_libs/" + SOC_TARGET_NAME + "/"]
objs = []
cppdefines = ['CONFIG_RTT=1']

group = DefineGroup('beken_sdk', src, depend = [''], CPPPATH = path, CPPDEFINES = cppdefines, LIBS = libs, LIBPATH = libpath)

for d in list:
    path = os.path.join(cwd, d)
    if os.path.isfile(os.path.join(path, 'SConscript')):
        objs = objs + SConscript(os.path.join(d, 'SConscript'))
objs = objs + group
Return('objs')
