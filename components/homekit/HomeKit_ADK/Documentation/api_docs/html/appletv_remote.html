

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Apple TV Remote &mdash; HomeKit ADK  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/tabs.js"></script>
        <script src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Firmware Update Service" href="firmware_update.html" />
    <link rel="prev" title="Adaptive Lighting Service" href="adaptive_light.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> HomeKit ADK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="adk_architecture.html">ADK Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="adk_directory_structure.html">ADK Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker with ADK</a></li>
</ul>
<p class="caption"><span class="caption-text">Step-by-step Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started with ADK</a></li>
<li class="toctree-l1"><a class="reference internal" href="raspi_setup.html">Raspberry Pi Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="bct.html">Bonjour Conformance Test (BCT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="wac_on_raspberrypi.html">WAC on Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera_on_darwin.html">Camera on macOS</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting ADK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interact_with_applications.html">Interacting with ADK applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting ADK</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_unit_tests.html">Writing Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug_adk.html">Debugging ADK Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">ADK Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="accessory_development.html">Accessory Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_pairing.html">Accessory Pairing</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_authentication.html">Accessory Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="provisioning_tools.html">Provisioning Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADK_Memory_Usage_and_Requirements.html">Memory Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="crypto.html">Cryptographic Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_options.html">Compile Time Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_convention.html">Coding Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_guide.html">ADK Migration Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">HomeKit Services</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="accessory_diagnostics.html">Accessory Diagnostics Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_metrics.html">Accessory Metrics Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="adaptive_light.html">Adaptive Lighting Service</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Apple TV Remote</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compile">Compile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run">Run</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-details">Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raspberry-pi-as-remote-example">Raspberry Pi as Remote Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#device-setup">Device Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#iphone-setup">iPhone Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#apple-tv-setup">Apple TV Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#background-information">Background Information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="firmware_update.html">Firmware Update Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="homekit_bridge.html">HomeKit Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip_camera.html">IP Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="lock_profile.html">Lock Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="stateless_programmable_switch.html">Stateless Programmable Switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="thread.html">HAP over Thread Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="wifi_reconfiguration_feature.html">WiFi Reconfiguration Service</a></li>
</ul>
<p class="caption"><span class="caption-text">PAL APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_api_docs/dir_PAL.html">Directory PAL</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HomeKit ADK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Apple TV Remote</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/appletv_remote.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="apple-tv-remote">
<h1>Apple TV Remote<a class="headerlink" href="#apple-tv-remote" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Apple TV Remotes profile allows a HomeKit accessory to control a target, which is an Apple TV. This document
describes the Apple TV Remote features in ADK. Please refer to <em>ADK/Applications/Remote</em> source for an example
implementation. Please also refer to section <em>Remotes for Apple TV</em> in HomeKit Accessory Protocol Specification.</p>
<div class="section" id="compile">
<h3>Compile<a class="headerlink" href="#compile" title="Permalink to this headline">¶</a></h3>
<p>You must have all the <a class="reference internal" href="getting_started.html"><span class="doc">prerequisites</span></a> for your development platform to compile the ADK. Once all
the prerequisites are installed for your platform, run the following to compile ADK with Apple TV Remote features:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-bWFjT1M=" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-bWFjT1M=" name="bWFjT1M=" role="tab" tabindex="0">macOS</button><button aria-controls="panel-0-TGludXg=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-TGludXg=" name="TGludXg=" role="tab" tabindex="-1">Linux</button><button aria-controls="panel-0-UmFzcGJlcnJ5IFBp" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-UmFzcGJlcnJ5IFBp" name="UmFzcGJlcnJ5IFBp" role="tab" tabindex="-1">Raspberry Pi</button><button aria-controls="panel-0-Tm9yZGljIG5SRjUy" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Tm9yZGljIG5SRjUy" name="Tm9yZGljIG5SRjUy" role="tab" tabindex="-1">Nordic nRF52</button></div><div aria-labelledby="tab-0-bWFjT1M=" class="sphinx-tabs-panel group-tab" id="panel-0-bWFjT1M=" name="bWFjT1M=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Darwin <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
<p>To enable Siri functionality for the Remote:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Darwin <span class="nv">USE_SIRI_REMOTE</span><span class="o">=</span><span class="m">1</span> <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
</div><div aria-labelledby="tab-0-TGludXg=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Linux <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
<p>To enable Siri functionality for the Remote:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Linux <span class="nv">USE_SIRI_REMOTE</span><span class="o">=</span><span class="m">1</span> <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
</div><div aria-labelledby="tab-0-UmFzcGJlcnJ5IFBp" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-UmFzcGJlcnJ5IFBp" name="UmFzcGJlcnJ5IFBp" role="tabpanel" tabindex="0"><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Raspi <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
<p>To enable Siri functionality for the Remote:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">TARGET</span><span class="o">=</span>Raspi <span class="nv">USE_SIRI_REMOTE</span><span class="o">=</span><span class="m">1</span> <span class="nv">APPS</span><span class="o">=</span>Remote
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Tm9yZGljIG5SRjUy" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Tm9yZGljIG5SRjUy" name="Tm9yZGljIG5SRjUy" role="tabpanel" tabindex="0"><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This feature is currently not supported on this platform.</p>
</div>
</div></div>
</div>
<div class="section" id="run">
<h3>Run<a class="headerlink" href="#run" title="Permalink to this headline">¶</a></h3>
<p>Please follow instructions at <a class="reference external" href="getting_started.html#step-5-running-an-adk-application">Running an ADK Application</a> to
run the Remote sample application.</p>
</div>
</div>
<div class="section" id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<p>As this profile needs relatively complex logic that is the same for all products, that common logic has been factored
out into the helper files <em>Remote.h/.c</em>. In order to simplify migration to future ADK versions, it is recommended that
a licensee not modify these helper files - so that they can easily be replaced by newer versions.</p>
<p>The Apple TV Remotes profile uses the HomeKit Data Stream (HDS) protocol for connections to a HomeKit hub (Apple TV).
A Remote service requires at least <em>8 KB</em> of RAM for HDS with the recommendation of <em>16 KB</em>. In addition, about <em>160 KB</em>
of RAM is needed for audio buffers and other data structures used in the Remote accessory logic and in the
microphone PAL module (e.g., audio buffers).</p>
<p>The maximum number of supported targets can be configured. In the Remote sample, every target gets its own key-value
store domain, defined in <em>Remote.c</em>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/** * Key value store domain for the first target of the remote. */</span><span class="w"></span>
<span class="cp">#define kAppKeyValueStoreDomain_TargetBegin    ((HAPPlatformKeyValueStoreDomain) 0x01)</span>

<span class="cm">/** * Key value store domain for the last target of the remote. */</span><span class="w"></span>
<span class="cp">#define kAppKeyValueStoreDomain_TargetEnd      ((HAPPlatformKeyValueStoreDomain) 0x14)</span>
</pre></div>
</div>
<p>In such a domain, the configuration of the target (e.g., Apple TV), is stored. From this information, the maximum number
of targets is computed as <code class="docutils literal notranslate"><span class="pre">kRemote_MaxTargets</span></code>. The configuration of the Remote itself is stored in another domain
<code class="docutils literal notranslate"><span class="pre">(kAppKeyValueStoreDomain_Configuration)</span></code>.</p>
</div>
<div class="section" id="raspberry-pi-as-remote-example">
<h2>Raspberry Pi as Remote Example<a class="headerlink" href="#raspberry-pi-as-remote-example" title="Permalink to this headline">¶</a></h2>
<p>A Raspberry Pi may also be used to demonstrate a remote control accessory. A Remote accessory requires a HomeKit hub,
i.e., an Apple TV. Here, an Apple TV is assumed as the hub, an iPhone as the iOS controller, and a Raspberry Pi as the
Remote accessory. The Remote sample application allows controlling an Apple TV with configurable buttons. The Remote
sample additionally contains support for Siri.</p>
<div class="section" id="device-setup">
<h3>Device Setup<a class="headerlink" href="#device-setup" title="Permalink to this headline">¶</a></h3>
<div class="section" id="iphone-setup">
<h4>iPhone Setup<a class="headerlink" href="#iphone-setup" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Make sure that the iPhone runs iOS 12 or later.</p></li>
<li><p>Set the region to the United States and the language to English.</p></li>
<li><p>Set up a HomeKit home.</p></li>
</ul>
</div>
<div class="section" id="apple-tv-setup">
<h4>Apple TV Setup<a class="headerlink" href="#apple-tv-setup" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Make sure that the Apple TV runs tvOS 12 or later.</p></li>
<li><p>Assign the Apple TV to the same Wi-Fi network as the iPhone, to the same Apple ID (iCloud ID) as the iPhone, and to
the same home as the iPhone.</p></li>
<li><p>Set the region to the United States and the language to English.</p></li>
<li><p>Enable AirPlay.</p></li>
<li><p>Turn on Home Sharing.</p></li>
<li><p>Make sure that iCloud and Home Sharing are connected to the same iCloud account.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The remote supports connecting to multiple Apple TVs on the same network.</p>
</div>
</div>
</div>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>The Remote application captures keyboard input from the console to emulate key presses. Key up and key down events are
sent separately to emulate physical button events and to allow for easier testing. The following key configuration is
configured in the remote:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Action</th>
<th>Down</th>
<th>Up</th>
</tr>
</thead>
<tbody>
<tr>
<td>Siri</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>Menu</td>
<td>q</td>
<td>w</td>
</tr>
<tr>
<td>Play / Pause</td>
<td>e</td>
<td>r</td>
</tr>
<tr>
<td>TV / Home</td>
<td>t</td>
<td>y</td>
</tr>
<tr>
<td>Select</td>
<td>u</td>
<td>i</td>
</tr>
<tr>
<td>Arrow Up</td>
<td>a</td>
<td>s</td>
</tr>
<tr>
<td>Arrow Right</td>
<td>d</td>
<td>f</td>
</tr>
<tr>
<td>Arrow Left</td>
<td>g</td>
<td>h</td>
</tr>
<tr>
<td>Volume Up</td>
<td>j</td>
<td>k</td>
</tr>
<tr>
<td>Volume Down</td>
<td>l</td>
<td>;</td>
</tr>
<tr>
<td>Power</td>
<td>c</td>
<td>v</td>
</tr>
<tr>
<td>Generic</td>
<td>b</td>
<td>n</td>
</tr>
</tbody>
</table><p>Before key presses can be sent, the remote needs to be paired with a controller that has at least one Apple TV
configured. If multiple Apple TVs are configured, the <em>m</em> key can be used to switch between the configured Apple TVs.
The <em>0</em> key is used to emulate a remote that controls a non-HomeKit entity.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Action</th>
<th>Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>Toggle Identifier / Apple TV</td>
<td>m</td>
</tr>
<tr>
<td>Set target to non HomeKit</td>
<td>0</td>
</tr>
</tbody>
</table><div class="admonition note">
<p class="admonition-title">Note</p>
<p>These key configurations also work for the remote bridge. Remote 1 will react to the key presses that are discussed
above. Remote 2 reacts to the same key presses with the additional Shift  key pressed (assumption: US/International
keyboard layout).</p>
</div>
</div>
<div class="section" id="background-information">
<h3>Background Information<a class="headerlink" href="#background-information" title="Permalink to this headline">¶</a></h3>
<p>Apple TVs are identified by an integer number. The Active Identifier denotes the currently active identifier, e.g.,
Apple TV. Each Apple TV will register itself with an identifier and the associated key configuration.</p>
<p>If the active identifier is set to <em>0</em>, the device indicates that it is either controlling a non-HomeKit entity or that
no Apple TV has been configured yet. In this case the following log message will be shown:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="m">2018</span>-10-17<span class="s1">&#39;T&#39;</span><span class="m">18</span>:12:34<span class="s1">&#39;Z&#39;</span>    Debug    <span class="o">[</span>com.apple.mfi.HomeKit.Remote:Remote<span class="o">]</span> RemoteRaiseButtonEvent: No active identifier is <span class="nb">set</span> <span class="k">for</span> the remote registered with remote 0x86388.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this message occurs even tough the Remote has been paired and an Apple TV is configured, then verify the Apple
TV/iPhone/Remote configuration discussed earlier.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="firmware_update.html" class="btn btn-neutral float-right" title="Firmware Update Service" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="adaptive_light.html" class="btn btn-neutral float-left" title="Adaptive Lighting Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright © 2021 Apple Inc. All Rights Reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>