

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>ADK Migration Guide &mdash; HomeKit ADK  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Accessory Diagnostics Service" href="accessory_diagnostics.html" />
    <link rel="prev" title="Coding Conventions" href="coding_convention.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> HomeKit ADK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="adk_architecture.html">ADK Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="adk_directory_structure.html">ADK Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker with ADK</a></li>
</ul>
<p class="caption"><span class="caption-text">Step-by-step Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started with ADK</a></li>
<li class="toctree-l1"><a class="reference internal" href="raspi_setup.html">Raspberry Pi Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="bct.html">Bonjour Conformance Test (BCT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="wac_on_raspberrypi.html">WAC on Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera_on_darwin.html">Camera on macOS</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting ADK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interact_with_applications.html">Interacting with ADK applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting ADK</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_unit_tests.html">Writing Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug_adk.html">Debugging ADK Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">ADK Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="accessory_development.html">Accessory Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_pairing.html">Accessory Pairing</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_authentication.html">Accessory Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="provisioning_tools.html">Provisioning Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADK_Memory_Usage_and_Requirements.html">Memory Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="crypto.html">Cryptographic Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_options.html">Compile Time Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_convention.html">Coding Conventions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ADK Migration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#from-adk-5-x-to-adk-6-x">From ADK 5.x to ADK 6.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="#migrating-from-non-adk-homekit-implementations-to-adk">Migrating from Non-ADK HomeKit Implementations to ADK</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">HomeKit Services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="accessory_diagnostics.html">Accessory Diagnostics Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="accessory_metrics.html">Accessory Metrics Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="adaptive_light.html">Adaptive Lighting Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="appletv_remote.html">Apple TV Remote</a></li>
<li class="toctree-l1"><a class="reference internal" href="firmware_update.html">Firmware Update Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="homekit_bridge.html">HomeKit Bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip_camera.html">IP Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="lock_profile.html">Lock Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="stateless_programmable_switch.html">Stateless Programmable Switch</a></li>
<li class="toctree-l1"><a class="reference internal" href="thread.html">HAP over Thread Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="wifi_reconfiguration_feature.html">WiFi Reconfiguration Service</a></li>
</ul>
<p class="caption"><span class="caption-text">PAL APIs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_api_docs/dir_PAL.html">Directory PAL</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HomeKit ADK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>ADK Migration Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/migration_guide.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adk-migration-guide">
<h1>ADK Migration Guide<a class="headerlink" href="#adk-migration-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="from-adk-5-x-to-adk-6-x">
<h2>From ADK 5.x to ADK 6.x<a class="headerlink" href="#from-adk-5-x-to-adk-6-x" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>ADK Integration Guide is replaced by this HTML documentation.</p></li>
<li><p>Modified the default button/Unix signal behavior for sample applications used for debugging purposes.</p></li>
<li><p>Enabled additional compiler warning flags such as <em>-Wextra</em>, <em>-wundef</em>, <em>-Wpedantic</em> and <em>-Wsign-compare</em>.</p></li>
<li><p>Enabled <em>ccache</em> for faster compilation.</p></li>
<li><p>Added BLE support for Rasbperry Pi.</p></li>
<li><p>Removed legacy WAC support.</p></li>
<li><p>Renamed compiler flag <em>HAP_THREAD_CERTIFICATION_OVERRIDES</em> to <em>HAP_FEATURE_THREAD_CERTIFICATION_OVERRIDES</em>.</p></li>
<li><p>Miscellaneous stability and usability fixes for IPCameras.</p></li>
<li><p>Added support for Accessory Diagnostics.</p></li>
<li><p>Added support for Accessory Metrics.</p></li>
<li><p>Added support for Accessory Firmware Update.</p></li>
<li><p>Added support for Access Code for Locks.</p></li>
<li><p>Added support for NFC Access for Locks.</p></li>
<li><p>Breaking Changes:</p>
<ul>
<li><p>Removed the following deprecated APIs:</p>
<ul>
<li><p><em>HAPAudioCodecParameters.type</em></p></li>
<li><p><em>HAPCharacteristicProperties.requiresAdminPermissions</em></p></li>
<li><p><em>HAPPlatform.ble.available</em> and <em>HAPPlatform.ip.available</em></p></li>
<li><p><em>HAPPlatform.ip.wac</em></p></li>
<li><p><em>HAPPlatformAccessorySetupCapabilities</em> APIs</p></li>
<li><p><em>HAPPlatformGetCompatibilityVersion</em> API</p></li>
<li><p><em>HAPPlatformWiFiManagerGetCapabilities</em> APIs</p></li>
<li><p><em>HAPTargetControlDataStreamProtocol.storage</em></p></li>
<li><p><em>kHAPServiceType_Lightbulb</em> and <em>kHAPServiceType_FanV2</em></p></li>
</ul>
</li>
<li><p>Updated IID for Siri Service for Remote Application.</p></li>
<li><p>Renamed <em>HAP_SIRI</em> feature macro to <em>HAP_SIRI_REMOTE</em> to be more descriptive.</p></li>
<li><p>Removed all deprecated HAP_ENUMs.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="migrating-from-non-adk-homekit-implementations-to-adk">
<h2>Migrating from Non-ADK HomeKit Implementations to ADK<a class="headerlink" href="#migrating-from-non-adk-homekit-implementations-to-adk" title="Permalink to this headline">¶</a></h2>
<p>When migrating from a different HomeKit SDK to the Apple ADK, certain steps need to be followed:</p>
<ul class="simple">
<li><p>The various aid and iid values in the HomeKit attribute database must match the previously used values. In the ADK
sample code those values can be adjusted in the DB.c file. It is important to keep those values the same across firmware
updates to prevent security issues and to avoid losing user-configured automations.</p></li>
<li><p>The firmwareVersion value in the HAPAccessory structure needs to be higher than the previously used value.</p></li>
<li><p>The accessory identity and pairing keys need to be imported into ADK before the initial <em>HAPAccessoryServerCreate</em> call.
The functions <em>HAPLegacyImportDeviceID</em>, <em>HAPLegacyImportConfigurationNumber</em>, <em>HAPLegacyImportLongTermSecretKey</em>,
<em>HAPLegacyImportUnsuccessfulAuthenticationAttemptsCounter</em>, and <em>HAPLegacyImportControllerPairing</em> may be used for this
purpose (see HAP.h). This ensures that the accessory remains paired after updating the firmware.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="accessory_diagnostics.html" class="btn btn-neutral float-right" title="Accessory Diagnostics Service" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="coding_convention.html" class="btn btn-neutral float-left" title="Coding Conventions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright © 2021 Apple Inc. All Rights Reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>